models:
    - name: cleaned_divvy_tripdata_2024
      columns:
        - name: ride_id
          config:
            tags: ["cleaned_ride_id"]
          data_tests:
            - unique
            - not_null
            - dbt_utils.expression_is_true:
                arguments:
                  expression: "NOT {{column_name}} RLIKE '^[[:space:]]+$'"
            - dbt_utils.expression_is_true:
                arguments:
                  expression: "{{ column_name }} RLIKE '^[A-F0-9]{16}$'"
        - name: started_at
          config: 
            tags: ["cleaned_started_at"]
          data_tests:
            - not_null
            - dbt_utils.expression_is_true:
                arguments:
                  expression: "<= ended_at"
        - name: ended_at
          config:
            tags: ["cleaned_ended_at"]
          data_tests:
            - not_null
            - dbt_utils.expression_is_true:
                arguments:
                  expression: ">= started_at"
        - name: rideable_type
          config:
              tags: [cleaned_rideable_type]
          data_tests:
            - not_null
            - accepted_values:
                arguments:
                    values: ["Electric Bike", "Classic Bike", "Scooter", "Electric Scooter", "Unknown Rideable"]
        - name: member_casual
          config:
              tags: [cleaned_member_casual]
          data_tests:
            - not_null
            - accepted_values:
                arguments:
                    values: ["Member", "Casual"]
        - name: start_station_name
          config:
              tags: [cleaned_start_station_name]
          data_tests:
            - not_null
            - dbt_utils.expression_is_true:
                arguments:
                  expression: "NOT {{column_name}} RLIKE '^[[:space:]]+$'"
        - name: end_station_name
          config: 
            tags: ["cleaned_end_station_name"]
          data_tests:
            - not_null:
                config:
                  where: "end_station_id IS NOT NULL"
        - name: start_lat
          config:
              tags: ["cleaned_start_lat"]
          data_tests:
            - dbt_utils.expression_is_true:
                arguments:
                    column_name: ""
                    expression: "start_lat >= 41.6 AND start_lat <= 42.1"
                config:
                    where: "start_lat IS NOT NULL"
            - not_null:
                config:
                    where: "start_lat IS NOT NULL"
        - name: start_lng
          config:
              tags: ["cleaned_start_lng"]
          data_tests:
            - dbt_utils.expression_is_true:
                arguments:
                    column_name: ""
                    expression: "start_lng >= -87.9 AND start_lng <= -87.5"
                config:
                    where: "start_lng IS NOT NULL"
            - not_null:
                config:
                    where: "start_lng IS NOT NULL"
        - name: end_lat
          config:
              tags: ["cleaned_end_lat"]
          data_tests:
            - dbt_utils.expression_is_true:
                arguments:
                    column_name: ""
                    expression: "end_lat >= 41.6 AND end_lat <= 42.1"
                config:
                    where: "end_lat IS NOT NULL"
            - not_null:
                config:
                  where: "end_lat IS NOT NULL"
        - name: end_lng
          config:
              tags: ["cleaned_end_lng"]
          data_tests:
            - dbt_utils.expression_is_true:
                arguments:
                    column_name: ""
                    expression: "end_lng >= -87.9 AND end_lng <= -87.5"
                config:
                    where: "end_lng IS NOT NULL"
            - not_null:
                config:
                  where: "end_lat IS NOT NULL"